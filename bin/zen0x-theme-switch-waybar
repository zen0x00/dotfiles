#!/bin/bash

THEMES="$HOME/.config/themes-waybar/"
CONFIG="$HOME/.config/waybar"


THEME=$(find "$THEMES" -mindepth 1 -maxdepth 1 -type d -printf "%f\n" | sort | rofi -dmenu -p "Waybar Theme")
[ -z "$THEME" ] && exit

if [ -L "$CONFIG" ]; then
  rm "$CONFIG"
elif [ -d "$CONFIG" ]; then
  mv "$CONFIG" "${CONFIG}.backup.$(date +%s)"
fi

ln -s "$THEMES/$THEME" "$CONFIG"

killall -SIGUSR2 waybar 2>/dev/null || waybar &
