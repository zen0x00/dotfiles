#!/bin/bash

THEMES="$HOME/.config/themes-waybar"
CONFIG="$HOME/.config/waybar"
GEN="$HOME/.config/zen0x/generated"

THEME=$(find -L "$THEMES" -mindepth 1 -maxdepth 1 -type d -printf "%f\n" | sort | rofi -dmenu -p "Waybar Theme")
[ -z "$THEME" ] && exit

mkdir -p "$CONFIG"

# Link layout files
ln -sfn "$THEMES/$THEME/config.jsonc" "$CONFIG/config.jsonc"
ln -sfn "$THEMES/$THEME/style.css" "$CONFIG/style.css"

# Always link generated colors
ln -sfn "$GEN/waybar-colors.css" "$CONFIG/colors.css"

pkill -SIGUSR2 waybar 2>/dev/null || waybar &
