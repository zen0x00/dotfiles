#!/usr/bin/env bash
set -e

image="$1"

if [ -z "$image" ]; then
    echo "Usage: set-wallpaper <image>"
    exit 1
fi

# Resolve absolute path
image="$(realpath "$image")"

# Update current wallpaper pointer (atomic)
ln -sf "$image" "$HOME/.current_wallpaper"

# Ensure awww is running
pgrep awww-daemon >/dev/null || awww init

# Apply wallpaper
awww img "$image" \
  --transition-type grow \
  --transition-fps 60 \
  --transition-duration 0.8
